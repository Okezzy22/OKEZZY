--EXAMPLE QUERY: SELECT MIN(PRICE) FROM HOUSEPRICES_CA, HAVING MIN(PRICE) > 500000, WHERE PROVINCE NOT LIKE 'O'
SELECT MIN(PRICE) AS MINPRICE, PROVINCE, CITY
FROM [dbo].[HOUSEPRICES_CA]
WHERE PROVINCE NOT LIKE '%O%'
GROUP BY PROVINCE, CITY
HAVING MIN(PRICE) > 500000
ORDER BY MIN(PRICE)

--EXAMPLE QUERY: WHAT IS THE AVERAGE PRICE OF HOUSE IN USA YEAR BTWN 2015 AND 2016 GROUP BY HOUSEID TO GET FULL RESULTS. 
SELECT AVG(PRICE) AS AVG_PRICE
FROM [dbo].[HOUSEPRICES_USA]
WHERE YEAR BETWEEN '2015' AND '2020'
GROUP BY HOUSEID

--EXAMPLE QUERY: SELECT CANADA AND USA HOUSEPRICES, ALIAS BOTH NAMES, INNERJOIN BOTH TABLES, WHERE BOTH HOUSEPRICES GRTEQL 500000 ORDER BY CANADA PRICE
SELECT [dbo].[HOUSEPRICES_CA].PRICE AS HOUSEPRICE_CA, [dbo].[HOUSEPRICES_USA].PRICE AS HOUSEPRICE_USA
FROM [dbo].[HOUSEPRICES_CA] INNER JOIN [dbo].[HOUSEPRICES_USA]
ON [dbo].[HOUSEPRICES_CA].HOUSEID = [dbo].[HOUSEPRICES_USA].HOUSEID
WHERE [dbo].[HOUSEPRICES_CA].PRICE >= 500000 AND [dbo].[HOUSEPRICES_USA].PRICE >= 500000
ORDER BY [dbo].[HOUSEPRICES_CA].PRICE

--EXAMPLE QUERY:SELECT HOUSEID, STATE, CITY, HOUSETYPE, PROVINCE, PRICE, FROM HOUSEPRICES_USA AND HOUSEPRICES_CA, FULL JOIN BOTH TABLES, GIVE A CONDITION AND WHERE PRICE LESSEQL 400000
SELECT [dbo].[HOUSEPRICES_USA].HOUSEID AS USAHOUSEID,[dbo].[HOUSEPRICES_USA].STATE AS USSTATES, [dbo].[HOUSEPRICES_USA].CITY AS USACITY, [dbo].[HOUSEPRICES_USA].HOUSETYPE AS USAHOUSETYPE, [dbo].[HOUSEPRICES_USA].PRICE AS USAPRICE,
[dbo].[HOUSEPRICES_CA].HOUSEID AS CAHOUSEID, [dbo].[HOUSEPRICES_CA].PROVINCE AS CAPROVINCE,
[dbo].[HOUSEPRICES_CA].CITY AS CACITY, [dbo].[HOUSEPRICES_CA].PRICE AS CAPRICE
FROM [dbo].[HOUSEPRICES_USA] FULL JOIN [dbo].[HOUSEPRICES_CA]
ON [dbo].[HOUSEPRICES_USA].HOUSEID = [dbo].[HOUSEPRICES_CA].HOUSEID
WHERE [dbo].[HOUSEPRICES_CA].PRICE <= 400000 AND [dbo].[HOUSEPRICES_USA].PRICE <= 400000


--EXAMPLE QUERY: CASE WHEN PRICE GRT AND EQL 300000 OR ELSE PRICE IS UNDER 300000, END RESULT TABLE ALIAS AS PRICECALC AND ORDER BY
SELECT HOUSEID, PRICE,
CASE
    WHEN PRICE > 300000 THEN 'THE PRICE IS GREATER THAN 300000'
    WHEN PRICE = 300000 THEN 'THE PRICE IS 300000'
    ELSE 'THE PRICE IS UNDER 300000'
END AS PRICECALC
FROM [dbo].[HOUSEPRICES_USA]
ORDER BY PRICECALC;

--EXAMPLE QUERY:GET THE FIFTH-HIGHEST PRICE FROM HOUSEPRICES_CA
SELECT TOP 1 PRICE, HOUSEID
FROM(
SELECT TOP 5 PRICE, HOUSEID
FROM [dbo].[HOUSEPRICES_CA]
ORDER BY PRICE DESC) AS PRICEDESC
ORDER BY PRICE ASC
