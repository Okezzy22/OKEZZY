CREATE PROCEDURE TEMP_HOUSEPRICE_USA
AS 
DROP TABLE IF EXISTS #TEXASHOUSE_PRICES
CREATE TABLE #USAHOUSEPRICES
(
HOUSEID INT,
    STATE VARCHAR(30),
    CITY VARCHAR(30),
    BEDROOMS INT,
    BATHROOMS INT,
    YEAR INT,
    PRICE INT,
    ZIPCODE INT
	);
	
	SELECT * INTO #USAHOUSEPRICES
	FROM [dbo].[HOUSEPRICES_USA]

	SELECT HOUSEID, STATE, CITY, BEDROOMS, BATHROOMS, AVG(PRICE) AS PRICE
	FROM [dbo].[HOUSEPRICES_USA]
	WHERE STATE = 'CALIFORNIA'
	GROUP BY HOUSEID, STATE, CITY, BEDROOMS, BATHROOMS

	SELECT * FROM #TEMPUSAHOUSEPRICES
