--CREATE TEMPORARY TABLE TO SEE INFORMATION OF TEXAS FROM AN EXISTING TABLE TO 'HOUSEPRICES_USA' IN SCHEMA 'DBO' IN DATABASE 'REALESTATEPRICES2'
CREATE TABLE #TEXASHOUSE_PRICES

SELECT * INTO #TEXASHOUSE_PRICES
FROM [dbo].[HOUSEPRICES_USA]
WHERE STATE = 'TEXAS'

--STATEMENT TO SEE TEMP TABLE CREATED
SELECT * FROM #TEXASHOUSE_PRICES

--DROP TEMP TABLE #TEXASHOUSE_PRICES
--DROP TABLE IF IT EXIST
DROP TABLE IF EXISTS #TEXASHOUSE_PRICES

-- CREATE VIEW TO COMPARE PRICES BETWEEN HOUSEPRICE_USA AND HOUSEPRICE_CA
CREATE VIEW HOUSEPRICE_COMPARISON_USA_CA
AS
SELECT 
[dbo].[HOUSEPRICES_CA].PROVINCE AS CA_LOCATION,
[dbo].[HOUSEPRICES_CA].BEDROOMS AS CA_BED,
[dbo].[HOUSEPRICES_CA].BATHROOMS AS CA_BATH,
[dbo].[HOUSEPRICES_CA].YEAR AS CA_YEAR,
[dbo].[HOUSEPRICES_USA].STATE AS USA_LOCATION,
[dbo].[HOUSEPRICES_USA].BEDROOMS AS USA_BED, 
[dbo].[HOUSEPRICES_USA].BATHROOMS AS USA_BATH,
[dbo].[HOUSEPRICES_CA].YEAR AS USA_YEAR
FROM [dbo].[HOUSEPRICES_CA]
JOIN [dbo].[HOUSEPRICES_USA] 
ON [dbo].[HOUSEPRICES_CA].YEAR = [dbo].[HOUSEPRICES_USA].YEAR

--PRICE MISSING ALTERED VIEW TO INSERT PRICE
SELECT TOP (1000) * FROM [dbo].[HOUSEPRICE_COMPARISON_USA_CA]

ALTER VIEW [dbo].[HOUSEPRICE_COMPARISON_USA_CA] AS
SELECT 
[dbo].[HOUSEPRICES_CA].PROVINCE AS CA_LOCATION,
[dbo].[HOUSEPRICES_CA].BEDROOMS AS CA_BED,
[dbo].[HOUSEPRICES_CA].BATHROOMS AS CA_BATH,
[dbo].[HOUSEPRICES_CA].YEAR AS CA_YEAR,
[dbo].[HOUSEPRICES_CA].PRICE AS CA_PRICE,
[dbo].[HOUSEPRICES_USA].STATE AS USA_LOCATION,
[dbo].[HOUSEPRICES_USA].BEDROOMS AS USA_BED, 
[dbo].[HOUSEPRICES_USA].BATHROOMS AS USA_BATH,
[dbo].[HOUSEPRICES_CA].YEAR AS USA_YEAR,
[dbo].[HOUSEPRICES_USA].PRICE AS USA_PRICE
FROM [dbo].[HOUSEPRICES_CA]
JOIN [dbo].[HOUSEPRICES_USA] 
ON [dbo].[HOUSEPRICES_CA].YEAR = [dbo].[HOUSEPRICES_USA].YEAR

--CREATE INDEX TABLE
CREATE UNIQUE INDEX CA_INDEX ON [dbo].[HOUSEPRICES_CA](BEDROOMS, PRICE, BATHROOMS, PROVINCE)

SELECT PROVINCE, BATHROOMS, BEDROOMS, PRICE FROM [dbo].[HOUSEPRICES_CA] INDEX_CA
WHERE BEDROOMS >= '5'


